<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Generate Playlist - Spotify Playlist Generator</title>
  <link rel="stylesheet" th:href="@{/css/unified-styles.css}">
  <link rel="stylesheet" th:href="@{/css/generate_playlist_styles.css}">
</head>
<body>
<nav class="navigation">
  <a href="/api/artists">Top Artists</a>
  <a href="/api/tracks">Top Tracks</a>
  <a href="/api/playlists">My Playlists</a>
  <a href="/api/generate-playlist" class="active">Generate Playlist</a>
</nav>

<div class="container">
  <h1 style="text-align: center; color: #333; margin-bottom: 30px;">🎵 Generate Your Perfect Playlist</h1>

  <form id="playlistForm" action="/api/generate-playlist" method="post">
    <!-- Mode Selection -->
    <div class="generation-mode">
      <div class="mode-header" onclick="selectMode('inspired')">
        <input type="radio" name="mode" value="inspired" id="inspired" class="mode-radio" checked>
        <div>
          <div class="mode-title">🎧 Get Inspired</div>
          <div class="mode-description">Generate based on your listening history and preferences</div>
        </div>
      </div>
    </div>

    <div class="generation-mode">
      <div class="mode-header" onclick="selectMode('custom')">
        <input type="radio" name="mode" value="custom" id="custom" class="mode-radio">
        <div>
          <div class="mode-title">🎨 Customize</div>
          <div class="mode-description">Pick your mood, genres, and artists for a tailored experience</div>
        </div>
      </div>

      <!-- Customization Options (Hidden by default) -->
      <div id="customization-options" style="display: none;">
        <!-- Mood Selection -->
        <div class="customization-section">
          <div class="section-toggle" onclick="toggleSection('mood')">
            <span class="section-title">🎭 What's your mood?</span>
            <span class="toggle-icon" id="mood-toggle">▼</span>
          </div>
          <div class="section-content" id="mood-content">
            <div class="mood-buttons">
              <div class="mood-button" onclick="selectMood(this, 'energetic')">⚡ Energetic</div>
              <div class="mood-button" onclick="selectMood(this, 'chill')">😌 Chill</div>
              <div class="mood-button" onclick="selectMood(this, 'focus')">🎯 Focus</div>
              <div class="mood-button" onclick="selectMood(this, 'party')">🎉 Party</div>
              <div class="mood-button" onclick="selectMood(this, 'workout')">💪 Workout</div>
              <div class="mood-button" onclick="selectMood(this, 'romantic')">💕 Romantic</div>
            </div>
            <input type="hidden" name="mood" id="selected-mood">
          </div>
        </div>

        <!-- Genre Selection -->
        <div class="customization-section">
          <div class="section-toggle" onclick="toggleSection('genres')">
            <span class="section-title">🎵 Choose genres (optional)</span>
            <span class="toggle-icon" id="genres-toggle">▼</span>
          </div>
          <div class="section-content" id="genres-content">
            <div class="genre-grid">
              <div class="checkbox-item">
                <input type="checkbox" name="genres" value="pop" id="pop">
                <label for="pop">Pop</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="genres" value="rock" id="rock">
                <label for="rock">Rock</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="genres" value="hip-hop" id="hip-hop">
                <label for="hip-hop">Hip Hop</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="genres" value="electronic" id="electronic">
                <label for="electronic">Electronic</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="genres" value="indie" id="indie">
                <label for="indie">Indie</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="genres" value="jazz" id="jazz">
                <label for="jazz">Jazz</label>
              </div>
            </div>
          </div>
        </div>

        <!-- Decades Selection -->
        <div class="customization-section">
          <div class="section-toggle" onclick="toggleSection('decades')">
            <span class="section-title">📅 Choose decades (optional)</span>
            <span class="toggle-icon" id="decades-toggle">▼</span>
          </div>
          <div class="section-content" id="decades-content">
            <div class="decade-grid">
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="2020s" id="2020s">
                <label for="2020s">2020s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="2010s" id="2010s">
                <label for="2010s">2010s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="2000s" id="2000s">
                <label for="2000s">2000s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="1990s" id="1990s">
                <label for="1990s">90s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="1980s" id="1980s">
                <label for="1980s">80s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="1970s" id="1970s">
                <label for="1970s">70s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="1960s" id="1960s">
                <label for="1960s">60s</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="decades" value="classic" id="classic">
                <label for="classic">Pre-60s</label>
              </div>
            </div>
          </div>
        </div>

        <!-- Artist Selection -->
        <div class="customization-section">
          <div class="section-toggle" onclick="toggleSection('artists')">
            <span class="section-title">👨‍🎤 Include specific artists (optional)</span>
            <span class="toggle-icon" id="artists-toggle">▼</span>
          </div>
          <div class="section-content" id="artists-content">
            <div class="form-group">
              <input type="text" name="artists" placeholder="Type artist names separated by commas..."
                     style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
              <div style="font-size: 12px; color: #666; margin-top: 4px;">
                Example: Taylor Swift, The Beatles, Drake
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- New Free Input Mode -->
    <div class="generation-mode">
      <div class="mode-header" onclick="selectMode('freeform')">
        <input type="radio" name="mode" value="freeform" id="freeform" class="mode-radio">
        <div>
          <div class="mode-title">✍️ Free Input</div>
          <div class="mode-description">Describe exactly what you want in your own words</div>
        </div>
      </div>

      <!-- Free Input Options (Hidden by default) -->
      <div id="freeform-options" style="display: none;">
        <div class="customization-section">
          <div class="form-group">
            <label for="freeform-query" style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
              🎵 Describe your perfect playlist:
            </label>
            <textarea name="freeformQuery" id="freeform-query" rows="4"
                      placeholder="Describe what kind of playlist you want... For example: 'I want upbeat indie rock songs perfect for a road trip with friends' or 'Create a chill jazz playlist for late night studying'"
                      style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical; min-height: 100px;"></textarea>
            <div style="font-size: 12px; color: #666; margin-top: 4px;">
              Be as specific as you want! Mention genres, moods, activities, or anything else that describes your ideal playlist.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Listening History Options -->
    <div class="listening-history-section" style="margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
      <h3 style="margin: 0 0 15px 0; color: #333; font-size: 16px;">🎧 Listening History Settings</h3>

      <div class="form-group" style="margin-bottom: 15px;">
        <label style="display: flex; align-items: center; font-weight: 500;">
          <input type="checkbox" name="useListeningHistory" id="use-listening-history" value="true" checked
                 style="margin-right: 8px;">
          Include my Spotify listening history
        </label>
        <div style="font-size: 12px; color: #666; margin-top: 4px; margin-left: 20px;">
          This helps personalize recommendations based on your music taste
        </div>
      </div>

      <div id="history-timeframe" class="form-group">
        <label for="timeframe" style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
          📊 Listening history timeframe:
        </label>
        <select name="timeframe" id="timeframe"
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
          <option value="short_term">Last 4 weeks</option>
          <option value="medium_term" selected>Last 6 months</option>
          <option value="long_term">Several years</option>
        </select>
      </div>
    </div>

    <!-- Generate Section -->
    <div class="generate-section">
      <button type="submit" class="generate-btn">🎶 Generate My Playlist</button>

      <!-- Spinner -->
      <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
      </div>

      <div class="quick-options">
        <div class="quick-option" onclick="quickGenerate('workout')">🏃‍♂️ Quick Workout Mix</div>
        <div class="quick-option" onclick="quickGenerate('chill')">☕ Coffee Shop Vibes</div>
        <div class="quick-option" onclick="quickGenerate('party')">🎉 Party Hits</div>
        <div class="quick-option" onclick="quickGenerate('discover')">🔍 Discover New Music</div>
      </div>
    </div>
  </form>
</div>

<script th:src="@{/js/generate-playlist.js}" type="text/javascript"></script>

</body>
</html>